<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIEM Analysis Training</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a2332;
            color: #ffffff;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .header {
            background: #2d4663;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #3a5a7a;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: bold;
            color: #ffffff;
        }

        .logo-subtitle {
            font-size: 13px;
            color: #a0c4e0;
            margin-left: 5px;
        }

        .training-badge {
            background: #ff6b35;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .main-container {
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 70px);
        }

        .docs-tab {
            position: fixed;
            top: 70px;
            right: 0;
            z-index: 999;
        }

        .docs-toggle {
            background: #4a90e2;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 6px 0 0 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s;
            writing-mode: vertical-lr;
            text-orientation: mixed;
        }

        .docs-toggle:hover {
            background: #357abd;
        }

        .docs-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 80%;
            height: 100vh;
            background: #1a2332;
            border-left: 2px solid #3a5a7a;
            z-index: 998;
            overflow-y: auto;
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .docs-panel:not(.hidden) {
            transform: translateX(0);
        }

        .docs-content {
            padding: 25px;
            color: #e8f4f8;
        }

        .close-docs {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #a0c4e0;
            font-size: 24px;
            cursor: pointer;
        }

        .doc-section {
            margin-bottom: 35px;
            background: #2d4663;
            padding: 25px;
            border-radius: 8px;
        }

        .doc-section h3 {
            color: #4CAF50;
            margin-bottom: 20px;
            border-bottom: 1px solid #3a5a7a;
            padding-bottom: 8px;
        }

        .policy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .policy-item {
            background: #1a2332;
            padding: 20px;
            border-radius: 6px;
            border-left: 4px solid #4a90e2;
        }

        .policy-item h4 {
            color: #ffd700;
            margin-bottom: 12px;
        }

        .policy-item ul {
            list-style: none;
            padding: 0;
        }

        .policy-item li {
            padding: 4px 0;
            font-size: 13px;
        }

        .access-table {
            overflow-x: auto;
            margin-top: 20px;
        }

        .access-table table {
            width: 100%;
            border-collapse: collapse;
            background: #2d4663;
        }

        .access-table th,
        .access-table td {
            padding: 10px 14px;
            text-align: left;
            border-bottom: 1px solid #3a5a7a;
            font-size: 12px;
        }

        .access-table th {
            background: #1a2332;
            color: #4CAF50;
            font-weight: bold;
        }

        .stats-bar {
            background: #2d4663;
            padding: 12px 20px;
            border-bottom: 1px solid #3a5a7a;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }

        .stats-left {
            display: flex;
            gap: 30px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-weight: bold;
            color: #4CAF50;
        }

        .new-session-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .new-session-btn:hover {
            background: #45a049;
        }

        .content-area {
            display: flex;
            flex: 1;
            min-height: 600px;
        }

        .events-list {
            width: 70%;
            background: #1a2332;
            border-right: 1px solid #3a5a7a;
            display: flex;
            flex-direction: column;
        }

        .events-container {
            flex: 1;
            overflow-y: auto;
            max-height: calc(100vh - 150px);
        }

        .events-table {
            width: 100%;
            border-collapse: collapse;
        }

        .events-table th,
        .events-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #2d4663;
            font-size: 12px;
        }

        .events-table th {
            background: #2d4663;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            color: #ffffff;
        }

        .events-table tr {
            cursor: pointer;
            transition: background 0.2s;
        }

        .events-table tr:hover {
            background: #2d4663;
        }

        .events-table tr.selected {
            background: #4a90e2;
        }

        .event-row.classified {
            opacity: 0.7;
        }

        .priority-critical { 
            color: #ff6b6b; 
            font-weight: bold;
        }
        .priority-high { 
            color: #ffa726; 
            font-weight: bold;
        }
        .priority-medium { 
            color: #ffcc02; 
            font-weight: bold;
        }
        .priority-low { 
            color: #66bb6a; 
        }

        .status-pending {
            color: #ffcc02;
            font-weight: bold;
        }

        .event-details-panel {
            width: 30%;
            background: #2d4663;
            padding: 25px;
            overflow-y: auto;
            max-height: calc(100vh - 150px);
            display: flex;
            flex-direction: column;
        }

        .event-details-panel.empty {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
            color: #a0c4e0;
            font-style: italic;
            text-align: left;
            padding-top: 40px;
        }

        .event-header {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #3a5a7a;
        }

        .event-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #ffffff;
        }

        .event-meta {
            font-size: 13px;
            color: #a0c4e0;
        }

        .event-actions {
            margin-top: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.2s;
        }

        .btn-danger {
            background: #e53e3e;
            color: white;
        }

        .btn-warning {
            background: #ff9800;
            color: white;
        }

        .btn-success {
            background: #4CAF50;
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            background: #3a5a7a;
            color: #87a3c1;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .field-group {
            margin-bottom: 18px;
        }

        .field-label {
            font-weight: bold;
            color: #ffffff;
            margin-bottom: 6px;
            font-size: 13px;
        }

        .field-value {
            background: #1a2332;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            word-break: break-all;
            border: 1px solid #3a5a7a;
        }

        .event-raw-data {
            background: #1a2332;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            margin-top: 20px;
            max-height: 250px;
            overflow-y: auto;
            border: 1px solid #3a5a7a;
        }

        .results-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .results-content {
            background: #1a2332;
            padding: 35px;
            border-radius: 12px;
            border: 2px solid #3a5a7a;
            max-width: 750px;
            width: 90%;
            text-align: center;
            max-height: 80vh;
            overflow-y: auto;
        }

        .results-title {
            font-size: 28px;
            margin-bottom: 25px;
            color: #4CAF50;
        }

        .score {
            font-size: 42px;
            font-weight: bold;
            color: #4a90e2;
            margin: 25px 0;
        }

        .results-details {
            margin: 25px 0;
            text-align: left;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: #2d4663;
            border-radius: 5px;
            font-size: 13px;
        }

        .correct {
            border-left: 4px solid #4CAF50;
        }

        .incorrect {
            border-left: 4px solid #e53e3e;
        }

        .hidden {
            display: none;
        }

        .classification-badge {
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 8px;
        }

        .classified-malicious { 
            background: #e53e3e; 
            color: white; 
        }
        
        .classified-suspicious { 
            background: #ff9800; 
            color: white; 
        }
        
        .classified-false-positive { 
            background: #4CAF50; 
            color: white; 
        }

        .investigation-tools {
            background: #1a2332;
            padding: 18px;
            border-radius: 6px;
            margin-top: 25px;
            border: 1px solid #3a5a7a;
        }

        .investigation-tools h4 {
            margin-bottom: 12px;
            color: #ffffff;
        }

        .tool-links {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .tool-link {
            color: #4CAF50;
            text-decoration: none;
            font-size: 12px;
            padding: 6px 10px;
            background: #2d4663;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .tool-link:hover {
            background: #3a5a7a;
        }

        .selectable-text {
            background: #3a5a7a;
            padding: 3px 6px;
            border-radius: 3px;
            cursor: pointer;
            user-select: all;
            transition: all 0.2s;
        }

        .selectable-text:hover {
            background: #4CAF50;
            color: #1a2332;
        }

        .copy-btn {
            position: relative;
        }

        .copy-btn:hover::after {
            content: 'Click to copy';
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: #1a2332;
            color: #4CAF50;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            white-space: nowrap;
            z-index: 1000;
            border: 1px solid #3a5a7a;
        }

        .copy-success::after {
            content: 'Copied!' !important;
            color: #4CAF50 !important;
        }

        .policy-allowed {
            color: #4CAF50;
            font-weight: bold;
            margin-right: 8px;
        }

        .policy-denied {
            color: #e53e3e;
            font-weight: bold;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="logo-text">SIEM Analysis Training</div>
            <div class="logo-subtitle">Security Event Investigation</div>
        </div>
        <div class="training-badge">TRAINING MODE</div>
    </div>

    <div class="main-container">
        <!-- Company Documentation Tab -->
        <div class="docs-tab" id="docsTab" style="top: 120px;">
            <button class="docs-toggle" onclick="toggleDocs()">📋 Company Documentation</button>
        </div>

        <!-- Company Documentation Panel -->
        <div class="docs-panel hidden" id="docsPanel">
            <div class="docs-content">
                <button class="close-docs" onclick="toggleDocs()">✕</button>
                <h2>ACMECORP Security Documentation</h2>
                
                <div class="doc-section">
                    <h3>Company Overview</h3>
                    <p><strong>ACMECORP Inc.</strong> is a mid-size technology consulting firm founded in 2010, specializing in digital transformation and cloud solutions. We employ 35 staff across 3 locations:</p>
                    <ul>
                        <li><strong>HQ:</strong> New York (20 employees) - Executive, Sales, Marketing, Finance</li>
                        <li><strong>Tech Hub:</strong> Austin (10 employees) - Development, DevOps, IT Operations</li>
                        <li><strong>EU Office:</strong> London (5 employees) - European sales and support</li>
                    </ul>
                    <p><strong>Business Hours:</strong> Monday-Friday 8:00 AM - 6:00 PM local time</p>
                    <p><strong>Remote Work:</strong> Hybrid model - employees work remotely 2-3 days per week</p>
                </div>

                <div class="doc-section">
                    <h3>Access Control Policy</h3>
                    <div class="policy-grid">
                        <div class="policy-item">
                            <h4>Database Access</h4>
                            <ul>
                                <li><span class="policy-allowed">✓</span> Database Admins (svc.backup, dba.smith)</li>
                                <li><span class="policy-allowed">✓</span> Finance Team (customer billing data only)</li>
                                <li><span class="policy-allowed">✓</span> HR Team (employee records only)</li>
                                <li><span class="policy-denied">✗</span> Security Guards, Contractors, Interns</li>
                                <li><span class="policy-denied">✗</span> Outside business hours without approval</li>
                            </ul>
                        </div>
                        <div class="policy-item">
                            <h4>Physical Access</h4>
                            <ul>
                                <li><span class="policy-allowed">✓</span> Employees: 6:00 AM - 10:00 PM</li>
                                <li><span class="policy-allowed">✓</span> Security Guards: 24/7</li>
                                <li><span class="policy-allowed">✓</span> Cleaning Crew: 10:00 PM - 6:00 AM</li>
                                <li><span class="policy-denied">✗</span> Contractors after hours</li>
                                <li><span class="policy-denied">✗</span> Visitors without escort</li>
                            </ul>
                        </div>
                        <div class="policy-item">
                            <h4>USB/External Media</h4>
                            <ul>
                                <li><span class="policy-allowed">✓</span> IT Department (approved devices)</li>
                                <li><span class="policy-allowed">✓</span> Executives (encrypted drives only)</li>
                                <li><span class="policy-denied">✗</span> General employees</li>
                                <li><span class="policy-denied">✗</span> Contractors and temps</li>
                                <li><span class="policy-denied">✗</span> Personal USB devices</li>
                            </ul>
                        </div>
                        <div class="policy-item">
                            <h4>Remote Access</h4>
                            <ul>
                                <li><span class="policy-allowed">✓</span> Employees via corporate VPN</li>
                                <li><span class="policy-allowed">✓</span> Approved remote workers</li>
                                <li><span class="policy-denied">✗</span> Non-corporate networks for sensitive data</li>
                                <li><span class="policy-denied">✗</span> International access without approval</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="doc-section">
                    <h3>Employee Access Matrix</h3>
                    <div class="access-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Department</th>
                                    <th>Role</th>
                                    <th>Database Access</th>
                                    <th>Admin Rights</th>
                                    <th>Physical Access</th>
                                    <th>Work Schedule</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>james.wilson</td><td>Executive</td><td>CEO</td><td>Read-Only</td><td>No</td><td>24/7</td><td>Flexible</td></tr>
                                <tr><td>sarah.martinez</td><td>Marketing</td><td>Manager</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM</td></tr>
                                <tr><td>michael.davis</td><td>Marketing</td><td>Specialist</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM</td></tr>
                                <tr><td>emily.rodriguez</td><td>Marketing</td><td>Coordinator</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 6 PM</td></tr>
                                <tr><td>john.thompson</td><td>Finance</td><td>Manager</td><td>Billing Only</td><td>No</td><td>Standard</td><td>8 AM - 6 PM</td></tr>
                                <tr><td>jennifer.brown</td><td>Finance</td><td>Analyst</td><td>Billing Only</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>robert.garcia</td><td>Finance</td><td>Analyst</td><td>Billing Only</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>lisa.anderson</td><td>HR</td><td>Manager</td><td>Employee Records</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>david.miller</td><td>HR</td><td>Specialist</td><td>Employee Records</td><td>No</td><td>Standard</td><td>9 AM - 5 PM</td></tr>
                                <tr><td>amanda.taylor</td><td>Sales</td><td>Director</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 7 PM</td></tr>
                                <tr><td>christopher.lee</td><td>Sales</td><td>Manager</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 6 PM</td></tr>
                                <tr><td>jennifer.davis</td><td>Sales</td><td>Rep</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 6 PM</td></tr>
                                <tr><td>matthew.white</td><td>Sales</td><td>Rep</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 6 PM</td></tr>
                                <tr><td>stephanie.clark</td><td>Sales</td><td>Rep</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>daniel.moore</td><td>Sales</td><td>Rep</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 6 PM</td></tr>
                                <tr><td>lauren.hall</td><td>Sales</td><td>Coordinator</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>kevin.young</td><td>Operations</td><td>Manager</td><td>No</td><td>No</td><td>Standard</td><td>7 AM - 6 PM</td></tr>
                                <tr><td>michelle.king</td><td>Operations</td><td>Analyst</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>david.wilson</td><td>IT</td><td>Director</td><td>No</td><td>Yes</td><td>Extended</td><td>7 AM - 7 PM</td></tr>
                                <tr><td>brian.johnson</td><td>IT</td><td>Admin</td><td>No</td><td>Yes</td><td>Extended</td><td>8 AM - 6 PM</td></tr>
                                <tr><td>ashley.adams</td><td>IT</td><td>Support</td><td>No</td><td>Limited</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>mike.chen</td><td>DevOps</td><td>Lead Engineer</td><td>No</td><td>Server Admin</td><td>Standard</td><td>Remote</td></tr>
                                <tr><td>alex.smith</td><td>DevOps</td><td>Engineer</td><td>No</td><td>Limited</td><td>Standard</td><td>Remote</td></tr>
                                <tr><td>tyler.jones</td><td>Development</td><td>Senior Dev</td><td>No</td><td>No</td><td>Standard</td><td>10 AM - 6 PM</td></tr>
                                <tr><td>natalie.green</td><td>Development</td><td>Developer</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM</td></tr>
                                <tr><td>carlos.rivera</td><td>Development</td><td>Developer</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 6 PM</td></tr>
                                <tr><td>samantha.parker</td><td>Development</td><td>Junior Dev</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM</td></tr>
                                <tr><td>jessica.lewis</td><td>QA</td><td>Lead Tester</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 5 PM</td></tr>
                                <tr><td>rachel.hill</td><td>Design</td><td>Lead Designer</td><td>No</td><td>No</td><td>Standard</td><td>10 AM - 6 PM</td></tr>
                                <tr><td>nicole.baker</td><td>EU Sales</td><td>Manager</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM GMT</td></tr>
                                <tr><td>james.cooper</td><td>EU Sales</td><td>Rep</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM GMT</td></tr>
                                <tr><td>hannah.wright</td><td>EU Support</td><td>Specialist</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 6 PM GMT</td></tr>
                                <tr><td>oliver.edwards</td><td>EU Support</td><td>Specialist</td><td>No</td><td>No</td><td>Standard</td><td>9 AM - 5 PM GMT</td></tr>
                                <tr><td>sophie.turner</td><td>EU Operations</td><td>Coordinator</td><td>No</td><td>No</td><td>Standard</td><td>8 AM - 5 PM GMT</td></tr>
                                <tr><td>rebecca.carter</td><td>Internship</td><td>Marketing Intern</td><td>No</td><td>No</td><td>Escorted Only</td><td>9 AM - 5 PM</td></tr>
                                <tr><td>richard.hughes</td><td>Security</td><td>Guard</td><td>No</td><td>No</td><td>24/7</td><td>Night Shift</td></tr>
                                <tr><td>jacob.turner</td><td>Security</td><td>Guard</td><td>No</td><td>No</td><td>24/7</td><td>Day Shift</td></tr>
                                <tr><td>joshua.phillips</td><td>Facilities</td><td>Maintenance</td><td>No</td><td>No</td><td>Extended</td><td>6 AM - 4 PM</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="doc-section">
                    <h3>Network & Security Policies</h3>
                    <div class="policy-grid">
                        <div class="policy-item">
                            <h4>Approved Ports</h4>
                            <ul>
                                <li><span class="policy-allowed">✓</span> 80, 443 (Web traffic)</li>
                                <li><span class="policy-allowed">✓</span> 22 (SSH - IT only)</li>
                                <li><span class="policy-allowed">✓</span> 3389 (RDP - IT only)</li>
                                <li><span class="policy-allowed">✓</span> 1433 (SQL - DB team)</li>
                                <li><span class="policy-denied">✗</span> 8080, 8888 (Alternative web)</li>
                                <li><span class="policy-denied">✗</span> 5900 (VNC)</li>
                                <li><span class="policy-denied">✗</span> Bitcoin/crypto ports</li>
                            </ul>
                        </div>
                        <div class="policy-item">
                            <h4>Incident Response</h4>
                            <ul>
                                <li>Report suspicious activity immediately</li>
                                <li>Do not investigate alone</li>
                                <li>Document all findings</li>
                                <li>Escalate policy violations</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stats-left">
                <div class="stat-item">
                    <span>Total Events:</span>
                    <span class="stat-value" id="totalEvents">25</span>
                </div>
                <div class="stat-item">
                    <span>Analyzed:</span>
                    <span class="stat-value" id="classifiedEvents">0</span>
                </div>
                <div class="stat-item">
                    <span>Remaining:</span>
                    <span class="stat-value" id="remainingEvents">25</span>
                </div>
                <div class="stat-item">
                    <span>Time Remaining:</span>
                    <span class="stat-value" id="timeRemaining">30:00</span>
                </div>
            </div>
            <div>
                <button class="new-session-btn" onclick="resetTraining()">🔄 New Training Session</button>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Events List -->
            <div class="events-list">
                <div class="events-container">
                    <table class="events-table">
                        <thead>
                            <tr>
                                <th style="width: 150px;">Timestamp</th>
                                <th style="width: 90px;">Severity</th>
                                <th style="width: 140px;">Event Type</th>
                                <th>Description</th>
                                <th style="width: 130px;">Source IP</th>
                                <th style="width: 130px;">Destination</th>
                                <th style="width: 100px;">Status</th>
                            </tr>
                        </thead>
                        <tbody id="eventsTableBody">
                            <!-- Events will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Event Details Panel -->
            <div class="event-details-panel empty" id="eventDetailsPanel">
                <div>
                    <h3>Event Investigation</h3>
                    <p>Select an event from the list to investigate</p>
                    <br>
                    <p><strong>Investigation Steps:</strong></p>
                    <p>1. Analyze the event details and raw logs</p>
                    <p>2. Use external tools to investigate suspicious elements</p>
                    <p>3. Classify the event based on your findings</p>
                    <br>
                    <p><strong>Classification Options:</strong></p>
                    <p>• <strong>Malicious</strong> - Confirmed threat requiring action</p>
                    <p>• <strong>Suspicious</strong> - Potentially malicious activity</p>
                    <p>• <strong>False Positive</strong> - Benign activity, no threat</p>
                </div>
            </div>
        </div>

        <!-- Results Modal -->
        <div class="results-modal hidden" id="resultsModal">
            <div class="results-content">
                <div class="results-title">Analysis Complete!</div>
                <div class="score" id="finalScore">0/25</div>
                <div class="results-details" id="resultsDetails">
                    <!-- Results will be populated here -->
                </div>
                <button class="btn btn-success" onclick="resetTraining()">Start New Analysis Session</button>
            </div>
        </div>
    </div>

    <script>
        let trainingEvents = [];
        let selectedEventId = null;
        let classificationsComplete = 0;
        let timerInterval = null;
        let timeRemaining = 30 * 60;

        // Event templates
        const eventTemplates = {
            malicious: [
                {
                    eventType: 'Network Connection',
                    description: 'Outbound TCP connection established',
                    sourceIP: '192.168.1.157',
                    destinationIP: '185.220.101.42',
                    destination: '185.220.101.42:8080',
                    severity: 'medium',
                    details: {
                        hostname: 'WS-MARKETING-07',
                        username: 'ACMECORP\\sarah.martinez',
                        protocol: 'TCP',
                        bytes_sent: '1247',
                        bytes_received: '8934',
                        duration: '00:04:23',
                        source_port: '49152',
                        destination_port: '8080'
                    }
                },
                {
                    eventType: 'File Download',
                    description: 'File downloaded from external source',
                    sourceIP: '192.168.1.89',
                    destinationIP: '94.232.47.156',
                    destination: 'update-manager.com',
                    severity: 'low',
                    details: {
                        hostname: 'WS-FINANCE-12',
                        username: 'ACMECORP\\john.thompson',
                        filename: 'system_update.exe',
                        file_size: '2847264',
                        hash_md5: 'd41d8cd98f00b204e9800998ecf8427e',
                        hash_sha256: 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855',
                        download_url: 'hxxp://update-manager[.]com/downloads/system_update.exe',
                        source_port: '443',
                        destination_port: '80'
                    }
                },
                {
                    eventType: 'Database Access',
                    description: 'Database query executed',
                    sourceIP: '192.168.1.188',
                    destinationIP: '192.168.1.200',
                    destination: 'DB-PROD-01.acmecorp.local',
                    severity: 'medium',
                    details: {
                        hostname: 'WS-SECURITY-01',
                        username: 'ACMECORP\\richard.hughes',
                        database: 'employee_records',
                        query: 'SELECT * FROM employees WHERE salary > 100000',
                        access_time: '02:15:32',
                        source_port: '1433',
                        destination_port: '1433',
                        table_accessed: 'employees'
                    }
                },
                {
                    eventType: 'Process Execution',
                    description: 'Process started on endpoint',
                    sourceIP: '192.168.1.112',
                    destinationIP: '192.168.1.112',
                    destination: 'localhost',
                    severity: 'medium',
                    details: {
                        hostname: 'WS-SALES-08',
                        username: 'ACMECORP\\jennifer.davis',
                        process_name: 'powershell.exe',
                        command_line: 'powershell.exe -enc SQBuAHYAbwBrAGUALQBXAGUAYgBSAGUAcQB1AGUAcwB0AC',
                        parent_process: 'winword.exe',
                        file_hash: '44d88612fea8a8f36de82e1278abb02f',
                        source_port: 'local',
                        destination_port: 'local'
                    }
                },
                {
                    eventType: 'Administrative Access',
                    description: 'Privileged account login detected',
                    sourceIP: '203.0.113.89',
                    destinationIP: '192.168.1.10',
                    destination: 'DC-PROD-01.acmecorp.local',
                    severity: 'high',
                    details: {
                        username: 'ACMECORP\\administrator',
                        login_source: 'External IP',
                        access_time: '03:22:45',
                        authentication_method: 'NTLM',
                        source_country: 'Unknown',
                        source_port: '3389',
                        destination_port: '3389',
                        session_duration: '00:08:15'
                    }
                },
                {
                    eventType: 'USB Device',
                    description: 'External storage device connected',
                    sourceIP: '192.168.1.67',
                    destinationIP: '192.168.1.67',
                    destination: 'localhost',
                    severity: 'medium',
                    details: {
                        hostname: 'WS-HR-02',
                        username: 'ACMECORP\\rebecca.carter',
                        device_type: 'USB_Mass_Storage',
                        vendor_id: '0x0781',
                        product_id: '0x5567',
                        serial_number: 'AA11223344556677',
                        device_name: 'SanDisk Ultra USB 3.0',
                        source_port: 'USB3',
                        destination_port: 'USB3',
                        files_accessed: '247'
                    }
                },
                {
                    eventType: 'Web Request',
                    description: 'HTTP request to external domain',
                    sourceIP: '192.168.1.178',
                    destinationIP: '198.12.75.112',
                    destination: 'bitcoinminer.best',
                    severity: 'low',
                    details: {
                        hostname: 'WS-IT-05',
                        username: 'ACMECORP\\david.wilson',
                        url: 'hxxps://bitcoinminer[.]best/api/v2/pool/connect',
                        method: 'POST',
                        status_code: '200',
                        user_agent: 'curl/7.68.0',
                        source_port: '49876',
                        destination_port: '443'
                    }
                },
                {
                    eventType: 'Email Attachment',
                    description: 'Email attachment processed',
                    sourceIP: '192.168.1.67',
                    destinationIP: '192.168.1.250',
                    destination: 'mail.acmecorp.local',
                    severity: 'low',
                    details: {
                        hostname: 'WS-HR-02',
                        username: 'ACMECORP\\lisa.anderson',
                        filename: 'invoice_march_2024.pdf.exe',
                        file_size: '1847392',
                        hash_md5: 'a665a45920422f9d417e4867efdc4fb8',
                        hash_sha256: '275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f',
                        sender: 'billing@totally-legitimate-company.org',
                        source_port: '25',
                        destination_port: '25'
                    }
                },
                {
                    eventType: 'DNS Query',
                    description: 'DNS resolution request',
                    sourceIP: '192.168.1.203',
                    destinationIP: '45.61.136.207',
                    destination: 'cmd-and-control.tk',
                    severity: 'low',
                    details: {
                        hostname: 'WS-DEVOPS-03',
                        username: 'ACMECORP\\mike.chen',
                        query_type: 'A',
                        response_ip: '45.61.136.207',
                        query_count: '47',
                        domain: 'cmd-and-control.tk',
                        source_port: '53',
                        destination_port: '53'
                    }
                },
                {
                    eventType: 'Network Scanner',
                    description: 'Port scanning activity detected',
                    sourceIP: '203.0.113.45',
                    destinationIP: '192.168.1.0',
                    destination: '192.168.1.0/24',
                    severity: 'high',
                    details: {
                        external_ip: '203.0.113.45',
                        target_network: '192.168.1.0/24',
                        ports_scanned: '22,23,80,443,3389,5900',
                        scan_type: 'TCP_SYN',
                        packets_sent: '1847',
                        source_country: 'Unknown',
                        source_port: 'random',
                        destination_port: 'multiple'
                    }
                },
                {
                    eventType: 'Data Exfiltration',
                    description: 'Large data transfer to personal cloud',
                    sourceIP: '192.168.1.145',
                    destinationIP: '157.240.12.35',
                    destination: 'personal-dropbox.com',
                    severity: 'high',
                    details: {
                        hostname: 'WS-FINANCE-09',
                        username: 'ACMECORP\\jennifer.brown',
                        bytes_transferred: '567891234',
                        transfer_duration: '00:45:12',
                        files_uploaded: '127',
                        encryption: 'none',
                        source_port: '443',
                        destination_port: '443'
                    }
                }
            ],
            falsePositive: [
                {
                    eventType: 'Software Update',
                    description: 'Application update process initiated',
                    sourceIP: '192.168.1.45',
                    destinationIP: '13.107.42.14',
                    destination: 'download.microsoft.com',
                    severity: 'low',
                    details: {
                        hostname: 'WS-EXECUTIVE-01',
                        username: 'ACMECORP\\james.wilson',
                        filename: 'windows-update-kb4023057.msu',
                        file_size: '15728640',
                        hash_md5: 'b4c1d9c6ef5a2e8f7a3d9b8c5e4f1a2b',
                        hash_sha256: '6e340b9cffb37a989ca544e6bb780a2c78901d3fb33738768511a30617afa01d',
                        download_url: 'https://download.microsoft.com/updates/kb4023057.msu',
                        source_port: '443',
                        destination_port: '443'
                    }
                },
                {
                    eventType: 'Database Backup',
                    description: 'Automated database backup operation',
                    sourceIP: '192.168.1.200',
                    destinationIP: '192.168.1.210',
                    destination: 'BACKUP-SRV-01.acmecorp.local',
                    severity: 'low',
                    details: {
                        hostname: 'DB-PROD-01',
                        username: 'ACMECORP\\svc.backup',
                        database: 'employee_records',
                        backup_size: '2847264000',
                        backup_location: '\\\\BACKUP-SRV-01\\db_backups\\',
                        scheduled_task: 'Daily_DB_Backup_02:00',
                        source_port: '1433',
                        destination_port: '1433'
                    }
                },
                {
                    eventType: 'VPN Connection',
                    description: 'Remote access connection established',
                    sourceIP: '78.47.162.89',
                    destinationIP: '192.168.1.1',
                    destination: 'vpn.acmecorp.com',
                    severity: 'medium',
                    details: {
                        external_ip: '78.47.162.89',
                        username: 'ACMECORP\\nicole.baker',
                        connection_duration: '08:15:32',
                        bytes_transferred: '847291648',
                        client_version: 'OpenVPN 2.5.7',
                        certificate_valid: 'true',
                        source_port: '1194',
                        destination_port: '1194'
                    }
                },
                {
                    eventType: 'Antivirus Scan',
                    description: 'Scheduled security scan completed',
                    sourceIP: '192.168.1.155',
                    destinationIP: '192.168.1.155',
                    destination: 'localhost',
                    severity: 'low',
                    details: {
                        hostname: 'WS-RESEARCH-09',
                        username: 'ACMECORP\\tyler.jones',
                        scan_type: 'full_system',
                        files_scanned: '287451',
                        threats_found: '0',
                        scan_duration: '02:34:17',
                        engine_version: 'ClamAV 1.1.20100.6',
                        source_port: 'local',
                        destination_port: 'local'
                    }
                },
                {
                    eventType: 'System Monitoring',
                    description: 'Performance monitoring agent update',
                    sourceIP: '192.168.1.188',
                    destinationIP: '104.18.34.243',
                    destination: 'monitoring.datadog.com',
                    severity: 'low',
                    details: {
                        hostname: 'WS-ANALYTICS-15',
                        username: 'ACMECORP\\michelle.king',
                        agent_version: 'v2.14.7',
                        update_size: '8847264',
                        signature_valid: 'true',
                        certificate: 'CN=Datadog Inc.',
                        source_port: '443',
                        destination_port: '443'
                    }
                },
                {
                    eventType: 'Patch Installation',
                    description: 'Security patch installation completed',
                    sourceIP: '192.168.1.77',
                    destinationIP: '192.168.1.251',
                    destination: 'WSUS-SRV-01.acmecorp.local',
                    severity: 'low',
                    details: {
                        hostname: 'WS-SUPPORT-13',
                        username: 'ACMECORP\\ashley.adams',
                        patch_id: 'KB5028166',
                        category: 'Security Updates',
                        install_status: 'successful',
                        reboot_required: 'false',
                        source_port: '80',
                        destination_port: '8530'
                    }
                },
                {
                    eventType: 'File Synchronization',
                    description: 'Cloud file sync operation',
                    sourceIP: '192.168.1.145',
                    destinationIP: '40.126.31.192',
                    destination: 'onedrive.live.com',
                    severity: 'low',
                    details: {
                        hostname: 'WS-DESIGN-07',
                        username: 'ACMECORP\\rachel.hill',
                        sync_folder: 'Documents',
                        files_synced: '47',
                        bytes_uploaded: '23847264',
                        user_account: 'rachel.hill@acmecorp.com',
                        source_port: '443',
                        destination_port: '443'
                    }
                },
                {
                    eventType: 'Print Job',
                    description: 'Document sent to network printer',
                    sourceIP: '192.168.1.92',
                    destinationIP: '192.168.1.210',
                    destination: 'PRINTER-01.acmecorp.local',
                    severity: 'low',
                    details: {
                        hostname: 'WS-FINANCE-03',
                        username: 'ACMECORP\\john.thompson',
                        document_name: 'Financial_Report_Q4.pdf',
                        pages: '24',
                        printer: 'HP_LaserJet_Floor2',
                        job_size: '2847264',
                        source_port: '9100',
                        destination_port: '9100'
                    }
                },
                {
                    eventType: 'Email Send',
                    description: 'Email sent to external recipient',
                    sourceIP: '192.168.1.156',
                    destinationIP: '192.168.1.250',
                    destination: 'mail.acmecorp.local',
                    severity: 'low',
                    details: {
                        hostname: 'WS-SALES-12',
                        username: 'ACMECORP\\christopher.lee',
                        recipient: 'client@partnercorp.com',
                        subject: 'Q1 Business Proposal',
                        attachment_count: '3',
                        message_size: '847264',
                        source_port: '25',
                        destination_port: '25'
                    }
                },
                {
                    eventType: 'Certificate Renewal',
                    description: 'SSL certificate auto-renewal process',
                    sourceIP: '192.168.1.250',
                    destinationIP: '172.65.32.183',
                    destination: 'acme-v02.api.letsencrypt.org',
                    severity: 'low',
                    details: {
                        hostname: 'MAIL-SRV-01',
                        username: 'ACMECORP\\svc.certificates',
                        domain: 'mail.acmecorp.com',
                        certificate_authority: 'Let\'s Encrypt Authority X3',
                        validity_period: '90 days',
                        renewal_status: 'successful',
                        source_port: '443',
                        destination_port: '443'
                    }
                }
            ]
        };

        function generateRandomTime() {
            const now = new Date();
            const timeAgo = new Date(now.getTime() - (Math.random() * 24 * 60 * 60 * 1000));
            return timeAgo.toISOString();
        }

        function generateRawEventData(event) {
            const timestamp = new Date(event.timestamp).toISOString();
            return `CEF:0|SecurityDevice|SIEM|1.0|${Math.floor(Math.random() * 9999)}|${event.description}|${event.severity === 'critical' ? '10' : event.severity === 'high' ? '7' : event.severity === 'medium' ? '5' : '3'}|
rt=${timestamp} src=${event.sourceIP} dst=${event.destinationIP || event.destination.split(':')[0] || event.destination}
spt=${event.details.source_port || Math.floor(Math.random() * 65535)} dpt=${event.details.destination_port || Math.floor(Math.random() * 65535)}
proto=TCP act=observed cs1Label=EventType cs1=${event.eventType}
msg=${event.description}`;
        }

        function initializeTraining() {
            trainingEvents = [];
            classificationsComplete = 0;
            selectedEventId = null;
            timeRemaining = 30 * 60;

            // Generate 15 malicious events
            const maliciousTemplates = [...eventTemplates.malicious];
            for (let i = 0; i < 15; i++) {
                const template = maliciousTemplates[i % maliciousTemplates.length];
                const event = {
                    id: Math.random().toString(36).substr(2, 9),
                    timestamp: generateRandomTime(),
                    severity: template.severity,
                    eventType: template.eventType,
                    description: template.description,
                    sourceIP: template.sourceIP,
                    destinationIP: template.destinationIP,
                    destination: template.destination,
                    details: template.details,
                    actualType: 'malicious',
                    userClassification: null,
                    rawData: null
                };
                event.rawData = generateRawEventData(event);
                trainingEvents.push(event);
            }

            // Generate 10 false positive events
            const fpTemplates = [...eventTemplates.falsePositive];
            for (let i = 0; i < 10; i++) {
                const template = fpTemplates[i % fpTemplates.length];
                const event = {
                    id: Math.random().toString(36).substr(2, 9),
                    timestamp: generateRandomTime(),
                    severity: template.severity,
                    eventType: template.eventType,
                    description: template.description,
                    sourceIP: template.sourceIP,
                    destinationIP: template.destinationIP,
                    destination: template.destination,
                    details: template.details,
                    actualType: 'false_positive',
                    userClassification: null,
                    rawData: null
                };
                event.rawData = generateRawEventData(event);
                trainingEvents.push(event);
            }

            // Shuffle events
            trainingEvents.sort(() => Math.random() - 0.5);

            renderEvents();
            updateStats();
            resetEventDetailsPanel();
            startTimer();
        }

        function renderEvents() {
            const tbody = document.getElementById('eventsTableBody');
            tbody.innerHTML = '';

            trainingEvents.forEach(event => {
                const row = document.createElement('tr');
                row.className = `event-row ${event.userClassification ? 'classified' : ''}`;
                row.onclick = () => selectEvent(event.id);
                
                if (selectedEventId === event.id) {
                    row.classList.add('selected');
                }

                const timestamp = new Date(event.timestamp).toLocaleString('en-US', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    hour12: false
                }).replace(',', '');
                
                let statusBadge = '';
                if (event.userClassification) {
                    const displayText = event.userClassification === 'false_positive' ? 'FALSE POSITIVE' : event.userClassification.toUpperCase();
                    const badgeClass = event.userClassification === 'false_positive' ? 'false-positive' : event.userClassification;
                    statusBadge = `<span class="classification-badge classified-${badgeClass}">${displayText}</span>`;
                } else {
                    statusBadge = '<span class="status-pending">PENDING</span>';
                }
                
                row.innerHTML = `
                    <td>${timestamp}</td>
                    <td><span class="priority-${event.severity}">${event.severity.toUpperCase()}</span></td>
                    <td>${event.eventType}</td>
                    <td>${event.description}</td>
                    <td>${event.sourceIP}</td>
                    <td>${event.destinationIP || event.destination.split(':')[0]}</td>
                    <td>${statusBadge}</td>
                `;

                tbody.appendChild(row);
            });
        }

        function selectEvent(eventId) {
            selectedEventId = eventId;
            const event = trainingEvents.find(e => e.id === eventId);
            
            if (!event) return;

            const panel = document.getElementById('eventDetailsPanel');
            panel.classList.remove('empty');

            const isClassified = event.userClassification !== null;
            const investigationTools = generateInvestigationTools(event);

            panel.innerHTML = `
                <div class="event-header">
                    <div class="event-title">${event.description}</div>
                    <div class="event-meta">Severity: ${event.severity.toUpperCase()} | Type: ${event.eventType} | ${new Date(event.timestamp).toLocaleString('en-US', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        hour12: false
                    }).replace(',', '')}</div>
                </div>

                <div class="event-actions">
                    <button class="btn btn-danger" onclick="classifyEvent('malicious')" ${isClassified ? 'disabled' : ''}>🚨 Malicious</button>
                    <button class="btn btn-warning" onclick="classifyEvent('suspicious')" ${isClassified ? 'disabled' : ''}>⚠️ Suspicious</button>
                    <button class="btn btn-success" onclick="classifyEvent('false_positive')" ${isClassified ? 'disabled' : ''}>✅ False Positive</button>
                </div>

                ${isClassified ? `
                <div style="background: #2d4663; padding: 12px; border-radius: 5px; margin: 18px 0; font-size: 13px; border: 1px solid #3a5a7a;">
                    <strong>Your Classification:</strong> ${event.userClassification === 'false_positive' ? 'FALSE POSITIVE' : event.userClassification.toUpperCase()}
                </div>
                ` : ''}

                <div id="eventDetailsContent">
                    <div class="field-group">
                        <div class="field-label">Event ID</div>
                        <div class="field-value">${event.id}</div>
                    </div>
                    
                    <div class="field-group">
                        <div class="field-label">Source IP</div>
                        <div class="field-value"><span class="selectable-text copy-btn" data-copy="${event.sourceIP}">${event.sourceIP}</span></div>
                    </div>
                    
                    <div class="field-group">
                        <div class="field-label">Destination IP</div>
                        <div class="field-value"><span class="selectable-text copy-btn" data-copy="${event.destinationIP}">${event.destinationIP}</span></div>
                    </div>
                    
                    <div class="field-group">
                        <div class="field-label">Destination</div>
                        <div class="field-value"><span class="selectable-text copy-btn" data-copy="${event.destination}">${event.destination}</span></div>
                    </div>

                    ${Object.entries(event.details).map(([key, value]) => `
                    <div class="field-group">
                        <div class="field-label">${key.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</div>
                        <div class="field-value">
                            <span class="selectable-text copy-btn" data-copy="${value}">${value}</span>
                        </div>
                    </div>
                    `).join('')}

                    <div class="investigation-tools">
                        <h4>Investigation Tools</h4>
                        <div class="tool-links">
                            ${investigationTools.map(tool => `
                                <a href="${tool.url}" target="_blank" class="tool-link">${tool.name}</a>
                            `).join('')}
                        </div>
                        <div style="margin-top: 12px; font-size: 11px; color: #a0c4e0;">
                            💡 Click on highlighted values to copy them instantly for investigation
                        </div>
                    </div>

                    <div class="event-raw-data">
                        <h4 style="margin-bottom: 12px; color: #ffffff;">Raw Event Data</h4>
                        <pre>${event.rawData}</pre>
                    </div>
                </div>
            `;

            renderEvents();
        }

        function generateInvestigationTools(event) {
            const tools = [
                { name: '🔍 AbuseIPDB - Check IP Reputation', url: 'https://www.abuseipdb.com/' },
                { name: '🌐 URLScan.io - Analyze URLs', url: 'https://urlscan.io/' },
                { name: '🦠 VirusTotal - File/Hash Analysis', url: 'https://www.virustotal.com/' },
                { name: '📊 Shodan - IP Intelligence', url: 'https://www.shodan.io/' },
                { name: '🔗 URLVoid - URL Reputation', url: 'https://www.urlvoid.com/' },
                { name: '📈 AlienVault OTX - Threat Intelligence', url: 'https://otx.alienvault.com/' }
            ];
            return tools;
        }

        function classifyEvent(classification) {
            if (!selectedEventId) return;
            
            const event = trainingEvents.find(e => e.id === selectedEventId);
            if (!event || event.userClassification) return;

            event.userClassification = classification;
            classificationsComplete++;

            selectEvent(selectedEventId);
            updateStats();

            if (classificationsComplete === trainingEvents.length) {
                setTimeout(showResults, 500);
            }
        }

        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    showTimeUpResults();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timeRemaining').textContent = display;
            
            const timerElement = document.getElementById('timeRemaining');
            if (timeRemaining <= 300) {
                timerElement.style.color = '#e53e3e';
            } else if (timeRemaining <= 600) {
                timerElement.style.color = '#ff9800';
            } else {
                timerElement.style.color = '#4CAF50';
            }
        }

        function showTimeUpResults() {
            showResults(true);
        }

        function updateStats() {
            document.getElementById('classifiedEvents').textContent = classificationsComplete;
            document.getElementById('remainingEvents').textContent = trainingEvents.length - classificationsComplete;
            updateTimerDisplay();
        }

        function showResults(timeUp = false) {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            let correctCount = 0;
            const resultsDetails = document.getElementById('resultsDetails');
            
            let detailsHTML = '';
            
            if (timeUp) {
                detailsHTML += '<div style="color: #e53e3e; font-weight: bold; margin-bottom: 20px; text-align: center;">⏰ Time\'s Up!</div>';
            }

            trainingEvents.forEach(event => {
                let isCorrect = false;
                
                if (event.userClassification) {
                    if (event.actualType === 'malicious' && (event.userClassification === 'malicious' || event.userClassification === 'suspicious')) {
                        isCorrect = true;
                    } else if (event.actualType === 'false_positive' && event.userClassification === 'false_positive') {
                        isCorrect = true;
                    }
                    
                    if (isCorrect) correctCount++;
                }

                const resultClass = event.userClassification ? (isCorrect ? 'correct' : 'incorrect') : 'incorrect';
                const resultIcon = event.userClassification ? (isCorrect ? '✅' : '❌') : '⏸️';
                const classificationText = event.userClassification ? 
                    (event.userClassification === 'false_positive' ? 'FALSE POSITIVE' : event.userClassification.toUpperCase()) : 
                    'NOT CLASSIFIED';
                
                detailsHTML += `
                    <div class="result-item ${resultClass}">
                        <div>
                            <strong>${event.description}</strong><br>
                            <small>Source: ${event.sourceIP} → ${event.destinationIP || event.destination}</small><br>
                            <small>Actual: ${event.actualType === 'false_positive' ? 'FALSE POSITIVE' : event.actualType.toUpperCase()} | Your: ${classificationText}</small>
                        </div>
                        <div>${resultIcon}</div>
                    </div>
                `;
            });

            resultsDetails.innerHTML = detailsHTML;
            document.getElementById('finalScore').textContent = `${correctCount}/${trainingEvents.length}`;
            document.getElementById('resultsModal').classList.remove('hidden');
        }

        function resetTraining() {
            document.getElementById('resultsModal').classList.add('hidden');
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            initializeTraining();
        }

        function resetEventDetailsPanel() {
            const panel = document.getElementById('eventDetailsPanel');
            panel.classList.add('empty');
            panel.innerHTML = `
                <div>
                    <h3>Event Investigation</h3>
                    <p>Select an event from the list to investigate</p>
                    <br>
                    <p><strong>Investigation Steps:</strong></p>
                    <p>1. Analyze the event details and raw logs</p>
                    <p>2. Use external tools to investigate suspicious elements</p>
                    <p>3. Classify the event based on your findings</p>
                    <br>
                    <p><strong>Classification Options:</strong></p>
                    <p>• <strong>Malicious</strong> - Confirmed threat requiring action</p>
                    <p>• <strong>Suspicious</strong> - Potentially malicious activity</p>
                    <p>• <strong>False Positive</strong> - Benign activity, no threat</p>
                </div>
            `;
        }

        function toggleDocs() {
            const panel = document.getElementById('docsPanel');
            panel.classList.toggle('hidden');
        }

        // Initialize training on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeTraining();
        });

        // Handle keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                resetEventDetailsPanel();
                selectedEventId = null;
                renderEvents();
            }
        });

        // Add click-to-copy functionality for investigation values
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('copy-btn')) {
                const textToCopy = e.target.getAttribute('data-copy');
                navigator.clipboard.writeText(textToCopy).then(() => {
                    e.target.classList.add('copy-success');
                    setTimeout(() => {
                        e.target.classList.remove('copy-success');
                    }, 1000);
                }).catch(() => {
                    const selection = window.getSelection();
                    const range = document.createRange();
                    range.selectNodeContents(e.target);
                    selection.removeAllRanges();
                    selection.addRange(range);
                });
            } else if (e.target.classList.contains('selectable-text')) {
                const selection = window.getSelection();
                const range = document.createRange();
                range.selectNodeContents(e.target);
                selection.removeAllRanges();
                selection.addRange(range);
            }
        });
    </script>
</body>
</html>